{
  "abbrlink": "10824f12",
  "category": "编程",
  "content": "<p>近来无事，想着博客推流时的指令有好几条，于是决定写一个小工具简化这个流程<!-- more --><span class=\"heimu\" title=\"你知道的太多了\">这甚至是我第一个实用性的程序</span></p>\n<h2 id=\"b4e0dcfe\">在此之前</h2>\n<p>我的博客配置好后每次从本地推送源码的指令有四条：</p>\n<div class=\"code-block-wrapper\">\n          <div class=\"code-block-header\">\n            <span class=\"code-lang\">SHELL</span>\n            <div class=\"copy-card\" onclick=\"window.copyToClipboard(this)\">Copy</div>\n          </div>\n          <pre class=\"shiki shiki-themes github-light github-dark\" style=\"background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8\" tabindex=\"0\"><code><span class=\"line\" data-line=\"1\" class=\"line\"><span style=\"color:#6F42C1;--shiki-dark:#B392F0\">git</span><span style=\"color:#032F62;--shiki-dark:#9ECBFF\"> pull</span><span style=\"color:#032F62;--shiki-dark:#9ECBFF\"> origin</span><span style=\"color:#032F62;--shiki-dark:#9ECBFF\"> master</span></span>\n<span class=\"line\" data-line=\"2\" class=\"line\"><span style=\"color:#6F42C1;--shiki-dark:#B392F0\">git</span><span style=\"color:#032F62;--shiki-dark:#9ECBFF\"> add</span><span style=\"color:#032F62;--shiki-dark:#9ECBFF\"> .</span></span>\n<span class=\"line\" data-line=\"3\" class=\"line\"><span style=\"color:#6F42C1;--shiki-dark:#B392F0\">git</span><span style=\"color:#032F62;--shiki-dark:#9ECBFF\"> commit</span><span style=\"color:#005CC5;--shiki-dark:#79B8FF\"> -m</span><span style=\"color:#032F62;--shiki-dark:#9ECBFF\">\"xxxxxx\"</span></span>\n<span class=\"line\" data-line=\"4\" class=\"line\"><span style=\"color:#6F42C1;--shiki-dark:#B392F0\">git</span><span style=\"color:#032F62;--shiki-dark:#9ECBFF\"> push</span><span style=\"color:#032F62;--shiki-dark:#9ECBFF\"> origin</span><span style=\"color:#032F62;--shiki-dark:#9ECBFF\"> master</span></span>\n<span class=\"line\" data-line=\"5\" class=\"line\"></span></code></pre>\n        </div>\n<p>这四条指令都在本地执行，所以每次推流都需要依次输入，而这显然是不方便的，于是我就想写一个能够自动执行这四条指令的工具。</p>\n<h2 id=\"2a3ee8c0\">程序设计</h2>\n<p>很简单，我们可以使用system()函数，其原型如下：</p>\n<div class=\"code-block-wrapper\">\n          <div class=\"code-block-header\">\n            <span class=\"code-lang\">CPP</span>\n            <div class=\"copy-card\" onclick=\"window.copyToClipboard(this)\">Copy</div>\n          </div>\n          <pre class=\"shiki shiki-themes github-light github-dark\" style=\"background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8\" tabindex=\"0\"><code><span class=\"line\" data-line=\"1\" class=\"line\"><span style=\"color:#D73A49;--shiki-dark:#F97583\">int</span><span style=\"color:#6F42C1;--shiki-dark:#B392F0\"> system</span><span style=\"color:#24292E;--shiki-dark:#E1E4E8\">(</span><span style=\"color:#D73A49;--shiki-dark:#F97583\">const</span><span style=\"color:#D73A49;--shiki-dark:#F97583\"> char</span><span style=\"color:#D73A49;--shiki-dark:#F97583\"> *</span><span style=\"color:#E36209;--shiki-dark:#FFAB70\">command</span><span style=\"color:#24292E;--shiki-dark:#E1E4E8\">);</span></span>\n<span class=\"line\" data-line=\"2\" class=\"line\"></span></code></pre>\n        </div>\n<p>给函数传入字符串型的命令行参数就可以在程序中执行命令，于是很容易想到执行这三条命令的代码：</p>\n<div class=\"code-block-wrapper\">\n          <div class=\"code-block-header\">\n            <span class=\"code-lang\">CPP</span>\n            <div class=\"copy-card\" onclick=\"window.copyToClipboard(this)\">Copy</div>\n          </div>\n          <pre class=\"shiki shiki-themes github-light github-dark\" style=\"background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8\" tabindex=\"0\"><code><span class=\"line\" data-line=\"1\" class=\"line\"><span style=\"color:#6F42C1;--shiki-dark:#B392F0\">system</span><span style=\"color:#24292E;--shiki-dark:#E1E4E8\">(</span><span style=\"color:#032F62;--shiki-dark:#9ECBFF\">\"git pull origin master\"</span><span style=\"color:#24292E;--shiki-dark:#E1E4E8\">);</span></span>\n<span class=\"line\" data-line=\"2\" class=\"line\"><span style=\"color:#6F42C1;--shiki-dark:#B392F0\">system</span><span style=\"color:#24292E;--shiki-dark:#E1E4E8\">(</span><span style=\"color:#032F62;--shiki-dark:#9ECBFF\">\"git add .\"</span><span style=\"color:#24292E;--shiki-dark:#E1E4E8\">);</span></span>\n<span class=\"line\" data-line=\"3\" class=\"line\"><span style=\"color:#6A737D;--shiki-dark:#6A737D\">//怎么样获取需要的commit呢？</span></span>\n<span class=\"line\" data-line=\"4\" class=\"line\"><span style=\"color:#6F42C1;--shiki-dark:#B392F0\">system</span><span style=\"color:#24292E;--shiki-dark:#E1E4E8\">(</span><span style=\"color:#032F62;--shiki-dark:#9ECBFF\">\"git push origin master\"</span><span style=\"color:#24292E;--shiki-dark:#E1E4E8\">);</span></span>\n<span class=\"line\" data-line=\"5\" class=\"line\"></span></code></pre>\n        </div>\n<p>这样除了commit提交外，其他的指令都可以自动执行。但这肯定是不完善且不可用的，因为commit的提交信息需要在<code>git add</code>与<code>git push</code>之间确定而不能在<code>git push</code>之后。</p>\n<p>于是我们需要在程序中获取commit信息，这样就可以在<code>git add</code>之后自动执行commit提交指令。很容易我们就可以想到一种方法：</p>\n<div class=\"code-block-wrapper\">\n          <div class=\"code-block-header\">\n            <span class=\"code-lang\">CPP</span>\n            <div class=\"copy-card\" onclick=\"window.copyToClipboard(this)\">Copy</div>\n          </div>\n          <pre class=\"shiki shiki-themes github-light github-dark\" style=\"background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8\" tabindex=\"0\"><code><span class=\"line\" data-line=\"1\" class=\"line\"><span style=\"color:#24292E;--shiki-dark:#E1E4E8\">string commit;</span></span>\n<span class=\"line\" data-line=\"2\" class=\"line\"><span style=\"color:#6F42C1;--shiki-dark:#B392F0\">getline</span><span style=\"color:#24292E;--shiki-dark:#E1E4E8\">(cin, commit);</span></span>\n<span class=\"line\" data-line=\"3\" class=\"line\"><span style=\"color:#24292E;--shiki-dark:#E1E4E8\">string commitInput </span><span style=\"color:#D73A49;--shiki-dark:#F97583\">=</span><span style=\"color:#032F62;--shiki-dark:#9ECBFF\"> \"git commit -m</span><span style=\"color:#005CC5;--shiki-dark:#79B8FF\">\\\"</span><span style=\"color:#032F62;--shiki-dark:#9ECBFF\">\"</span><span style=\"color:#D73A49;--shiki-dark:#F97583\"> +</span><span style=\"color:#24292E;--shiki-dark:#E1E4E8\"> commit </span><span style=\"color:#D73A49;--shiki-dark:#F97583\">+</span><span style=\"color:#032F62;--shiki-dark:#9ECBFF\"> \"</span><span style=\"color:#005CC5;--shiki-dark:#79B8FF\">\\\"</span><span style=\"color:#032F62;--shiki-dark:#9ECBFF\">\"</span><span style=\"color:#24292E;--shiki-dark:#E1E4E8\">;</span></span>\n<span class=\"line\" data-line=\"4\" class=\"line\"><span style=\"color:#6F42C1;--shiki-dark:#B392F0\">system</span><span style=\"color:#24292E;--shiki-dark:#E1E4E8\">(commitInput.</span><span style=\"color:#6F42C1;--shiki-dark:#B392F0\">c_str</span><span style=\"color:#24292E;--shiki-dark:#E1E4E8\">());</span></span>\n<span class=\"line\" data-line=\"5\" class=\"line\"></span></code></pre>\n        </div>\n<p>但我认为这样还不够简洁，我们需要的是一行可以直接推流的指令而不是一个需要用户输入的软件，所以我们需要另一种方式——获取命令行。</p>\n<h3 id=\"c47838ef\">获取命令行</h3>\n<p>一般的c++程序中，我们的main函数都是这样定义的：</p>\n<div class=\"code-block-wrapper\">\n          <div class=\"code-block-header\">\n            <span class=\"code-lang\">CPP</span>\n            <div class=\"copy-card\" onclick=\"window.copyToClipboard(this)\">Copy</div>\n          </div>\n          <pre class=\"shiki shiki-themes github-light github-dark\" style=\"background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8\" tabindex=\"0\"><code><span class=\"line\" data-line=\"1\" class=\"line\"><span style=\"color:#D73A49;--shiki-dark:#F97583\">int</span><span style=\"color:#6F42C1;--shiki-dark:#B392F0\"> main</span><span style=\"color:#24292E;--shiki-dark:#E1E4E8\">(</span><span style=\"color:#D73A49;--shiki-dark:#F97583\">void</span><span style=\"color:#24292E;--shiki-dark:#E1E4E8\">) {</span></span>\n<span class=\"line\" data-line=\"2\" class=\"line\"><span style=\"color:#6A737D;--shiki-dark:#6A737D\">    //...</span></span>\n<span class=\"line\" data-line=\"3\" class=\"line\"><span style=\"color:#24292E;--shiki-dark:#E1E4E8\">}</span></span>\n<span class=\"line\" data-line=\"4\" class=\"line\"></span></code></pre>\n        </div>\n<p>但为了获取命令行参数，我们就需要像这样定义：</p>\n<div class=\"code-block-wrapper\">\n          <div class=\"code-block-header\">\n            <span class=\"code-lang\">CPP</span>\n            <div class=\"copy-card\" onclick=\"window.copyToClipboard(this)\">Copy</div>\n          </div>\n          <pre class=\"shiki shiki-themes github-light github-dark\" style=\"background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8\" tabindex=\"0\"><code><span class=\"line\" data-line=\"1\" class=\"line\"><span style=\"color:#D73A49;--shiki-dark:#F97583\">int</span><span style=\"color:#6F42C1;--shiki-dark:#B392F0\"> main</span><span style=\"color:#24292E;--shiki-dark:#E1E4E8\">(</span><span style=\"color:#D73A49;--shiki-dark:#F97583\">int</span><span style=\"color:#E36209;--shiki-dark:#FFAB70\"> argc</span><span style=\"color:#24292E;--shiki-dark:#E1E4E8\">, </span><span style=\"color:#D73A49;--shiki-dark:#F97583\">char</span><span style=\"color:#D73A49;--shiki-dark:#F97583\"> **</span><span style=\"color:#E36209;--shiki-dark:#FFAB70\">argv</span><span style=\"color:#24292E;--shiki-dark:#E1E4E8\">) {</span></span>\n<span class=\"line\" data-line=\"2\" class=\"line\"><span style=\"color:#6A737D;--shiki-dark:#6A737D\">    //...</span></span>\n<span class=\"line\" data-line=\"3\" class=\"line\"><span style=\"color:#24292E;--shiki-dark:#E1E4E8\">}</span></span>\n<span class=\"line\" data-line=\"4\" class=\"line\"></span></code></pre>\n        </div>\n<p>其中，argc是命令行参数的个数，argv则是一个指针数组，每个指针指向一个字符串，每个字符串是一个命令行参数。当我们执行一个可执行文件时，若是只在命令提示符中输入可执行文件的文件名，像这样：</p>\n<div class=\"code-block-wrapper\">\n          <div class=\"code-block-header\">\n            <span class=\"code-lang\">SHELL</span>\n            <div class=\"copy-card\" onclick=\"window.copyToClipboard(this)\">Copy</div>\n          </div>\n          <pre class=\"shiki shiki-themes github-light github-dark\" style=\"background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8\" tabindex=\"0\"><code><span class=\"line\" data-line=\"1\" class=\"line\"><span style=\"color:#6F42C1;--shiki-dark:#B392F0\">BlogPusher</span></span>\n<span class=\"line\" data-line=\"2\" class=\"line\"></span></code></pre>\n        </div>\n<p>那么argc的值就是1，而argv[0]的值就是BlogPusher，而若是在命令提示符中输入可执行文件的文件名和参数，像这样：</p>\n<div class=\"code-block-wrapper\">\n          <div class=\"code-block-header\">\n            <span class=\"code-lang\">SHELL</span>\n            <div class=\"copy-card\" onclick=\"window.copyToClipboard(this)\">Copy</div>\n          </div>\n          <pre class=\"shiki shiki-themes github-light github-dark\" style=\"background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8\" tabindex=\"0\"><code><span class=\"line\" data-line=\"1\" class=\"line\"><span style=\"color:#6F42C1;--shiki-dark:#B392F0\">BlogPusher</span><span style=\"color:#032F62;--shiki-dark:#9ECBFF\"> Update</span><span style=\"color:#032F62;--shiki-dark:#9ECBFF\"> About</span></span>\n<span class=\"line\" data-line=\"2\" class=\"line\"></span></code></pre>\n        </div>\n<p>此时argc的值就是3，argv[0]的值仍是BlogPusher，但后面argv[1]的值则会是Update，argv[2]的值是About。</p>\n<p>所以，我们就可以这样获取到我们需要的commit信息了。</p>\n<h3 id=\"cc707cf8\">Commit信息处理</h3>\n<p>光是获取还不够，现在我们需要处理我们获取到的参数。在刚刚的例子中，我们可以看到argv数组的分割是以空格为基础的，但commit中可以包含空格，这就使得直接使用argv[1]是不可行的。</p>\n<p>所以，我们需要一种方法来处理commit信息，使其可以正确包含空格。其实很简单，只需要加入一个循环，每次循环获取一个字符串并把它放入字符串commit中，在每一个字符串之间加入空格即可。</p>\n<div class=\"code-block-wrapper\">\n          <div class=\"code-block-header\">\n            <span class=\"code-lang\">CPP</span>\n            <div class=\"copy-card\" onclick=\"window.copyToClipboard(this)\">Copy</div>\n          </div>\n          <pre class=\"shiki shiki-themes github-light github-dark\" style=\"background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8\" tabindex=\"0\"><code><span class=\"line\" data-line=\"1\" class=\"line\"><span style=\"color:#24292E;--shiki-dark:#E1E4E8\">string commit;</span></span>\n<span class=\"line\" data-line=\"2\" class=\"line\"><span style=\"color:#24292E;--shiki-dark:#E1E4E8\">    string commit;</span></span>\n<span class=\"line\" data-line=\"3\" class=\"line\"><span style=\"color:#D73A49;--shiki-dark:#F97583\">    for</span><span style=\"color:#24292E;--shiki-dark:#E1E4E8\">(</span><span style=\"color:#D73A49;--shiki-dark:#F97583\">int</span><span style=\"color:#24292E;--shiki-dark:#E1E4E8\"> i </span><span style=\"color:#D73A49;--shiki-dark:#F97583\">=</span><span style=\"color:#005CC5;--shiki-dark:#79B8FF\"> 1</span><span style=\"color:#24292E;--shiki-dark:#E1E4E8\">; i </span><span style=\"color:#D73A49;--shiki-dark:#F97583\">&#x3C;</span><span style=\"color:#24292E;--shiki-dark:#E1E4E8\"> argc; i</span><span style=\"color:#D73A49;--shiki-dark:#F97583\">++</span><span style=\"color:#24292E;--shiki-dark:#E1E4E8\">){</span></span>\n<span class=\"line\" data-line=\"4\" class=\"line\"><span style=\"color:#24292E;--shiki-dark:#E1E4E8\">        commit </span><span style=\"color:#D73A49;--shiki-dark:#F97583\">+=</span><span style=\"color:#24292E;--shiki-dark:#E1E4E8\"> argv[i];</span></span>\n<span class=\"line\" data-line=\"5\" class=\"line\"><span style=\"color:#D73A49;--shiki-dark:#F97583\">        if</span><span style=\"color:#24292E;--shiki-dark:#E1E4E8\">(i </span><span style=\"color:#D73A49;--shiki-dark:#F97583\">!=</span><span style=\"color:#24292E;--shiki-dark:#E1E4E8\"> argc </span><span style=\"color:#D73A49;--shiki-dark:#F97583\">-</span><span style=\"color:#005CC5;--shiki-dark:#79B8FF\"> 1</span><span style=\"color:#24292E;--shiki-dark:#E1E4E8\">){</span></span>\n<span class=\"line\" data-line=\"6\" class=\"line\"><span style=\"color:#24292E;--shiki-dark:#E1E4E8\">            commit </span><span style=\"color:#D73A49;--shiki-dark:#F97583\">+=</span><span style=\"color:#032F62;--shiki-dark:#9ECBFF\"> \" \"</span><span style=\"color:#24292E;--shiki-dark:#E1E4E8\">;</span></span>\n<span class=\"line\" data-line=\"7\" class=\"line\"><span style=\"color:#24292E;--shiki-dark:#E1E4E8\">        }</span></span>\n<span class=\"line\" data-line=\"8\" class=\"line\"><span style=\"color:#24292E;--shiki-dark:#E1E4E8\">    }</span></span>\n<span class=\"line\" data-line=\"9\" class=\"line\"></span></code></pre>\n        </div>\n<p>加了一个判断，使得程序不会给commit信息加入多余的空格。现在，commit信息就可以正确的包含空格了。</p>\n<h2 id=\"1fd4c48b\">总结</h2>\n<p>所有程序合在一起差不多是这样：</p>\n<div class=\"code-block-wrapper\">\n          <div class=\"code-block-header\">\n            <span class=\"code-lang\">CPP</span>\n            <div class=\"copy-card\" onclick=\"window.copyToClipboard(this)\">Copy</div>\n          </div>\n          <pre class=\"shiki shiki-themes github-light github-dark\" style=\"background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8\" tabindex=\"0\"><code><span class=\"line\" data-line=\"1\" class=\"line\"><span style=\"color:#D73A49;--shiki-dark:#F97583\">#include</span><span style=\"color:#032F62;--shiki-dark:#9ECBFF\"> &#x3C;iostream></span></span>\n<span class=\"line\" data-line=\"2\" class=\"line\"><span style=\"color:#D73A49;--shiki-dark:#F97583\">using</span><span style=\"color:#D73A49;--shiki-dark:#F97583\"> namespace</span><span style=\"color:#6F42C1;--shiki-dark:#B392F0\"> std</span><span style=\"color:#24292E;--shiki-dark:#E1E4E8\">;</span></span>\n<span class=\"line\" data-line=\"3\" class=\"line\"></span>\n<span class=\"line\" data-line=\"4\" class=\"line\"><span style=\"color:#D73A49;--shiki-dark:#F97583\">int</span><span style=\"color:#6F42C1;--shiki-dark:#B392F0\"> main</span><span style=\"color:#24292E;--shiki-dark:#E1E4E8\">(</span><span style=\"color:#D73A49;--shiki-dark:#F97583\">int</span><span style=\"color:#E36209;--shiki-dark:#FFAB70\"> argc</span><span style=\"color:#24292E;--shiki-dark:#E1E4E8\">, </span><span style=\"color:#D73A49;--shiki-dark:#F97583\">char**</span><span style=\"color:#E36209;--shiki-dark:#FFAB70\"> argv</span><span style=\"color:#24292E;--shiki-dark:#E1E4E8\">){</span></span>\n<span class=\"line\" data-line=\"5\" class=\"line\"><span style=\"color:#24292E;--shiki-dark:#E1E4E8\">    string commit;</span></span>\n<span class=\"line\" data-line=\"6\" class=\"line\"><span style=\"color:#D73A49;--shiki-dark:#F97583\">    for</span><span style=\"color:#24292E;--shiki-dark:#E1E4E8\">(</span><span style=\"color:#D73A49;--shiki-dark:#F97583\">int</span><span style=\"color:#24292E;--shiki-dark:#E1E4E8\"> i </span><span style=\"color:#D73A49;--shiki-dark:#F97583\">=</span><span style=\"color:#005CC5;--shiki-dark:#79B8FF\"> 1</span><span style=\"color:#24292E;--shiki-dark:#E1E4E8\">; i </span><span style=\"color:#D73A49;--shiki-dark:#F97583\">&#x3C;</span><span style=\"color:#24292E;--shiki-dark:#E1E4E8\"> argc; i</span><span style=\"color:#D73A49;--shiki-dark:#F97583\">++</span><span style=\"color:#24292E;--shiki-dark:#E1E4E8\">){</span></span>\n<span class=\"line\" data-line=\"7\" class=\"line\"><span style=\"color:#24292E;--shiki-dark:#E1E4E8\">        commit </span><span style=\"color:#D73A49;--shiki-dark:#F97583\">+=</span><span style=\"color:#24292E;--shiki-dark:#E1E4E8\"> argv[i];</span></span>\n<span class=\"line\" data-line=\"8\" class=\"line\"><span style=\"color:#D73A49;--shiki-dark:#F97583\">        if</span><span style=\"color:#24292E;--shiki-dark:#E1E4E8\">(i </span><span style=\"color:#D73A49;--shiki-dark:#F97583\">!=</span><span style=\"color:#24292E;--shiki-dark:#E1E4E8\"> argc </span><span style=\"color:#D73A49;--shiki-dark:#F97583\">-</span><span style=\"color:#005CC5;--shiki-dark:#79B8FF\"> 1</span><span style=\"color:#24292E;--shiki-dark:#E1E4E8\">){</span></span>\n<span class=\"line\" data-line=\"9\" class=\"line\"><span style=\"color:#24292E;--shiki-dark:#E1E4E8\">            commit </span><span style=\"color:#D73A49;--shiki-dark:#F97583\">+=</span><span style=\"color:#032F62;--shiki-dark:#9ECBFF\"> \" \"</span><span style=\"color:#24292E;--shiki-dark:#E1E4E8\">;</span></span>\n<span class=\"line\" data-line=\"10\" class=\"line\"><span style=\"color:#24292E;--shiki-dark:#E1E4E8\">        }</span></span>\n<span class=\"line\" data-line=\"11\" class=\"line\"><span style=\"color:#24292E;--shiki-dark:#E1E4E8\">    }</span></span>\n<span class=\"line\" data-line=\"12\" class=\"line\"><span style=\"color:#24292E;--shiki-dark:#E1E4E8\">    string commitInput </span><span style=\"color:#D73A49;--shiki-dark:#F97583\">=</span><span style=\"color:#032F62;--shiki-dark:#9ECBFF\"> \"git commit -m</span><span style=\"color:#005CC5;--shiki-dark:#79B8FF\">\\\"</span><span style=\"color:#032F62;--shiki-dark:#9ECBFF\">\"</span><span style=\"color:#D73A49;--shiki-dark:#F97583\"> +</span><span style=\"color:#24292E;--shiki-dark:#E1E4E8\"> commit </span><span style=\"color:#D73A49;--shiki-dark:#F97583\">+</span><span style=\"color:#032F62;--shiki-dark:#9ECBFF\"> \"</span><span style=\"color:#005CC5;--shiki-dark:#79B8FF\">\\\"</span><span style=\"color:#032F62;--shiki-dark:#9ECBFF\">\"</span><span style=\"color:#24292E;--shiki-dark:#E1E4E8\">;</span></span>\n<span class=\"line\" data-line=\"13\" class=\"line\"><span style=\"color:#6F42C1;--shiki-dark:#B392F0\">    system</span><span style=\"color:#24292E;--shiki-dark:#E1E4E8\">(</span><span style=\"color:#032F62;--shiki-dark:#9ECBFF\">\"git pull origin master\"</span><span style=\"color:#24292E;--shiki-dark:#E1E4E8\">);</span></span>\n<span class=\"line\" data-line=\"14\" class=\"line\"><span style=\"color:#6F42C1;--shiki-dark:#B392F0\">    system</span><span style=\"color:#24292E;--shiki-dark:#E1E4E8\">(</span><span style=\"color:#032F62;--shiki-dark:#9ECBFF\">\"git add .\"</span><span style=\"color:#24292E;--shiki-dark:#E1E4E8\">);</span></span>\n<span class=\"line\" data-line=\"15\" class=\"line\"><span style=\"color:#24292E;--shiki-dark:#E1E4E8\">    cout</span><span style=\"color:#D73A49;--shiki-dark:#F97583\">&#x3C;&#x3C;</span><span style=\"color:#032F62;--shiki-dark:#9ECBFF\">\"git add success\"</span><span style=\"color:#D73A49;--shiki-dark:#F97583\">&#x3C;&#x3C;</span><span style=\"color:#24292E;--shiki-dark:#E1E4E8\">endl;</span></span>\n<span class=\"line\" data-line=\"16\" class=\"line\"><span style=\"color:#6F42C1;--shiki-dark:#B392F0\">    system</span><span style=\"color:#24292E;--shiki-dark:#E1E4E8\">(commitInput.</span><span style=\"color:#6F42C1;--shiki-dark:#B392F0\">c_str</span><span style=\"color:#24292E;--shiki-dark:#E1E4E8\">());</span></span>\n<span class=\"line\" data-line=\"17\" class=\"line\"><span style=\"color:#6F42C1;--shiki-dark:#B392F0\">    system</span><span style=\"color:#24292E;--shiki-dark:#E1E4E8\">(</span><span style=\"color:#032F62;--shiki-dark:#9ECBFF\">\"git push origin master\"</span><span style=\"color:#24292E;--shiki-dark:#E1E4E8\">);</span></span>\n<span class=\"line\" data-line=\"18\" class=\"line\"><span style=\"color:#D73A49;--shiki-dark:#F97583\">    return</span><span style=\"color:#005CC5;--shiki-dark:#79B8FF\"> 0</span><span style=\"color:#24292E;--shiki-dark:#E1E4E8\">;</span></span>\n<span class=\"line\" data-line=\"19\" class=\"line\"><span style=\"color:#24292E;--shiki-dark:#E1E4E8\">}</span></span>\n<span class=\"line\" data-line=\"20\" class=\"line\"></span></code></pre>\n        </div>\n<p>编译，放入博客源码文件夹下。注意此时不要忘记在.gitignore中添加一行<code>blogpusher.*</code>，防止git上传时上传blogpusher文件。</p>\n<p>在命令提示符中输入<code>blogpusher Update .gitignore</code>，测试一下，非常完美！</p>\n<p>最后优化一下，差不多像这样：</p>\n<div class=\"code-block-wrapper\">\n          <div class=\"code-block-header\">\n            <span class=\"code-lang\">CPP</span>\n            <div class=\"copy-card\" onclick=\"window.copyToClipboard(this)\">Copy</div>\n          </div>\n          <pre class=\"shiki shiki-themes github-light github-dark\" style=\"background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8\" tabindex=\"0\"><code><span class=\"line\" data-line=\"1\" class=\"line\"><span style=\"color:#D73A49;--shiki-dark:#F97583\">#include</span><span style=\"color:#032F62;--shiki-dark:#9ECBFF\"> &#x3C;iostream></span></span>\n<span class=\"line\" data-line=\"2\" class=\"line\"><span style=\"color:#D73A49;--shiki-dark:#F97583\">using</span><span style=\"color:#D73A49;--shiki-dark:#F97583\"> namespace</span><span style=\"color:#6F42C1;--shiki-dark:#B392F0\"> std</span><span style=\"color:#24292E;--shiki-dark:#E1E4E8\">;</span></span>\n<span class=\"line\" data-line=\"3\" class=\"line\"></span>\n<span class=\"line\" data-line=\"4\" class=\"line\"><span style=\"color:#D73A49;--shiki-dark:#F97583\">int</span><span style=\"color:#6F42C1;--shiki-dark:#B392F0\"> main</span><span style=\"color:#24292E;--shiki-dark:#E1E4E8\">(</span><span style=\"color:#D73A49;--shiki-dark:#F97583\">int</span><span style=\"color:#E36209;--shiki-dark:#FFAB70\"> argc</span><span style=\"color:#24292E;--shiki-dark:#E1E4E8\">, </span><span style=\"color:#D73A49;--shiki-dark:#F97583\">char**</span><span style=\"color:#E36209;--shiki-dark:#FFAB70\"> argv</span><span style=\"color:#24292E;--shiki-dark:#E1E4E8\">){</span></span>\n<span class=\"line\" data-line=\"5\" class=\"line\"><span style=\"color:#24292E;--shiki-dark:#E1E4E8\">    string commit;</span></span>\n<span class=\"line\" data-line=\"6\" class=\"line\"><span style=\"color:#D73A49;--shiki-dark:#F97583\">    for</span><span style=\"color:#24292E;--shiki-dark:#E1E4E8\">(</span><span style=\"color:#D73A49;--shiki-dark:#F97583\">int</span><span style=\"color:#24292E;--shiki-dark:#E1E4E8\"> i </span><span style=\"color:#D73A49;--shiki-dark:#F97583\">=</span><span style=\"color:#005CC5;--shiki-dark:#79B8FF\"> 1</span><span style=\"color:#24292E;--shiki-dark:#E1E4E8\">; i </span><span style=\"color:#D73A49;--shiki-dark:#F97583\">&#x3C;</span><span style=\"color:#24292E;--shiki-dark:#E1E4E8\"> argc; i</span><span style=\"color:#D73A49;--shiki-dark:#F97583\">++</span><span style=\"color:#24292E;--shiki-dark:#E1E4E8\">){</span></span>\n<span class=\"line\" data-line=\"7\" class=\"line\"><span style=\"color:#24292E;--shiki-dark:#E1E4E8\">        commit </span><span style=\"color:#D73A49;--shiki-dark:#F97583\">+=</span><span style=\"color:#24292E;--shiki-dark:#E1E4E8\"> argv[i];</span></span>\n<span class=\"line\" data-line=\"8\" class=\"line\"><span style=\"color:#D73A49;--shiki-dark:#F97583\">        if</span><span style=\"color:#24292E;--shiki-dark:#E1E4E8\">(i </span><span style=\"color:#D73A49;--shiki-dark:#F97583\">!=</span><span style=\"color:#24292E;--shiki-dark:#E1E4E8\"> argc </span><span style=\"color:#D73A49;--shiki-dark:#F97583\">-</span><span style=\"color:#005CC5;--shiki-dark:#79B8FF\"> 1</span><span style=\"color:#24292E;--shiki-dark:#E1E4E8\">){</span></span>\n<span class=\"line\" data-line=\"9\" class=\"line\"><span style=\"color:#24292E;--shiki-dark:#E1E4E8\">            commit </span><span style=\"color:#D73A49;--shiki-dark:#F97583\">+=</span><span style=\"color:#032F62;--shiki-dark:#9ECBFF\"> \" \"</span><span style=\"color:#24292E;--shiki-dark:#E1E4E8\">;</span></span>\n<span class=\"line\" data-line=\"10\" class=\"line\"><span style=\"color:#24292E;--shiki-dark:#E1E4E8\">        }</span></span>\n<span class=\"line\" data-line=\"11\" class=\"line\"><span style=\"color:#24292E;--shiki-dark:#E1E4E8\">    }</span></span>\n<span class=\"line\" data-line=\"12\" class=\"line\"><span style=\"color:#24292E;--shiki-dark:#E1E4E8\">    string commitInput </span><span style=\"color:#D73A49;--shiki-dark:#F97583\">=</span><span style=\"color:#032F62;--shiki-dark:#9ECBFF\"> \"git commit -m</span><span style=\"color:#005CC5;--shiki-dark:#79B8FF\">\\\"</span><span style=\"color:#032F62;--shiki-dark:#9ECBFF\">\"</span><span style=\"color:#D73A49;--shiki-dark:#F97583\"> +</span><span style=\"color:#24292E;--shiki-dark:#E1E4E8\"> commit </span><span style=\"color:#D73A49;--shiki-dark:#F97583\">+</span><span style=\"color:#032F62;--shiki-dark:#9ECBFF\"> \"</span><span style=\"color:#005CC5;--shiki-dark:#79B8FF\">\\\"</span><span style=\"color:#032F62;--shiki-dark:#9ECBFF\">\"</span><span style=\"color:#24292E;--shiki-dark:#E1E4E8\">;</span></span>\n<span class=\"line\" data-line=\"13\" class=\"line\"><span style=\"color:#24292E;--shiki-dark:#E1E4E8\">    cout</span><span style=\"color:#D73A49;--shiki-dark:#F97583\">&#x3C;&#x3C;</span><span style=\"color:#032F62;--shiki-dark:#9ECBFF\">\"==========BEGIN PULL==========\"</span><span style=\"color:#D73A49;--shiki-dark:#F97583\">&#x3C;&#x3C;</span><span style=\"color:#24292E;--shiki-dark:#E1E4E8\">endl;</span></span>\n<span class=\"line\" data-line=\"14\" class=\"line\"><span style=\"color:#6F42C1;--shiki-dark:#B392F0\">    system</span><span style=\"color:#24292E;--shiki-dark:#E1E4E8\">(</span><span style=\"color:#032F62;--shiki-dark:#9ECBFF\">\"git pull origin master\"</span><span style=\"color:#24292E;--shiki-dark:#E1E4E8\">);</span></span>\n<span class=\"line\" data-line=\"15\" class=\"line\"><span style=\"color:#24292E;--shiki-dark:#E1E4E8\">    cout</span><span style=\"color:#D73A49;--shiki-dark:#F97583\">&#x3C;&#x3C;</span><span style=\"color:#032F62;--shiki-dark:#9ECBFF\">\"==========BEGIN ADD==========\"</span><span style=\"color:#D73A49;--shiki-dark:#F97583\">&#x3C;&#x3C;</span><span style=\"color:#24292E;--shiki-dark:#E1E4E8\">endl;</span></span>\n<span class=\"line\" data-line=\"16\" class=\"line\"><span style=\"color:#6F42C1;--shiki-dark:#B392F0\">    system</span><span style=\"color:#24292E;--shiki-dark:#E1E4E8\">(</span><span style=\"color:#032F62;--shiki-dark:#9ECBFF\">\"git add .\"</span><span style=\"color:#24292E;--shiki-dark:#E1E4E8\">);</span></span>\n<span class=\"line\" data-line=\"17\" class=\"line\"><span style=\"color:#24292E;--shiki-dark:#E1E4E8\">    cout</span><span style=\"color:#D73A49;--shiki-dark:#F97583\">&#x3C;&#x3C;</span><span style=\"color:#032F62;--shiki-dark:#9ECBFF\">\"git add success\"</span><span style=\"color:#D73A49;--shiki-dark:#F97583\">&#x3C;&#x3C;</span><span style=\"color:#24292E;--shiki-dark:#E1E4E8\">endl;</span></span>\n<span class=\"line\" data-line=\"18\" class=\"line\"><span style=\"color:#24292E;--shiki-dark:#E1E4E8\">    cout</span><span style=\"color:#D73A49;--shiki-dark:#F97583\">&#x3C;&#x3C;</span><span style=\"color:#032F62;--shiki-dark:#9ECBFF\">\"==========BEGIN COMMIT==========\"</span><span style=\"color:#D73A49;--shiki-dark:#F97583\">&#x3C;&#x3C;</span><span style=\"color:#24292E;--shiki-dark:#E1E4E8\">endl;</span></span>\n<span class=\"line\" data-line=\"19\" class=\"line\"><span style=\"color:#6F42C1;--shiki-dark:#B392F0\">    system</span><span style=\"color:#24292E;--shiki-dark:#E1E4E8\">(commitInput.</span><span style=\"color:#6F42C1;--shiki-dark:#B392F0\">c_str</span><span style=\"color:#24292E;--shiki-dark:#E1E4E8\">());</span></span>\n<span class=\"line\" data-line=\"20\" class=\"line\"><span style=\"color:#24292E;--shiki-dark:#E1E4E8\">    cout</span><span style=\"color:#D73A49;--shiki-dark:#F97583\">&#x3C;&#x3C;</span><span style=\"color:#032F62;--shiki-dark:#9ECBFF\">\"==========BEGIN PUSH==========\"</span><span style=\"color:#D73A49;--shiki-dark:#F97583\">&#x3C;&#x3C;</span><span style=\"color:#24292E;--shiki-dark:#E1E4E8\">endl;</span></span>\n<span class=\"line\" data-line=\"21\" class=\"line\"><span style=\"color:#6F42C1;--shiki-dark:#B392F0\">    system</span><span style=\"color:#24292E;--shiki-dark:#E1E4E8\">(</span><span style=\"color:#032F62;--shiki-dark:#9ECBFF\">\"git push origin master\"</span><span style=\"color:#24292E;--shiki-dark:#E1E4E8\">);</span></span>\n<span class=\"line\" data-line=\"22\" class=\"line\"><span style=\"color:#D73A49;--shiki-dark:#F97583\">    return</span><span style=\"color:#005CC5;--shiki-dark:#79B8FF\"> 0</span><span style=\"color:#24292E;--shiki-dark:#E1E4E8\">;</span></span>\n<span class=\"line\" data-line=\"23\" class=\"line\"><span style=\"color:#24292E;--shiki-dark:#E1E4E8\">}</span></span>\n<span class=\"line\" data-line=\"24\" class=\"line\"></span></code></pre>\n        </div>\n<p>大功告成！</p>\n<h2 id=\"f23d890d\">题外话</h2>\n<p>这个东西很早就想做了的说......现在做出来了还是十分欣慰。</p>\n<p>程序已经开源到了<a href=\"https://github.com/OrdChaos/BlogPusher\">github</a>，欢迎查看。若是帮到了您的话，麻烦点个star，谢谢。</p>\n",
  "date": "2022-07-25 19:30:28",
  "excerpt": "近来无事，想着博客推流时的指令有好几条，于是决定写一个小工具简化这个流程",
  "readTime": "10",
  "summary": "这篇博文介绍了博主如何设计一个C++命令行工具来自动化博客推流的Git操作，通过解析main函数的argc和argv参数获取用户输入的commit信息，并将其与git pull、add、commit、push指令结合，实现一键推流功能。",
  "tags": [
    "github",
    "开源软件",
    "计算机",
    "编程",
    "cpp"
  ],
  "title": "一键推流工具—— BlogPusher",
  "toc": [
    {
      "id": "b4e0dcfe",
      "level": 2,
      "text": "在此之前"
    },
    {
      "id": "2a3ee8c0",
      "level": 2,
      "text": "程序设计"
    },
    {
      "id": "c47838ef",
      "level": 3,
      "text": "获取命令行"
    },
    {
      "id": "cc707cf8",
      "level": 3,
      "text": "Commit信息处理"
    },
    {
      "id": "1fd4c48b",
      "level": 2,
      "text": "总结"
    },
    {
      "id": "f23d890d",
      "level": 2,
      "text": "题外话"
    }
  ],
  "updated": "2022-07-25 19:30:28"
}